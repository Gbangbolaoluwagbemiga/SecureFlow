(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[105],{50:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>I});var a=s(3365),i=s(1521),r=s(6170),n=s(7408),o=s(740),c=s(5096),l=s(919),d=s(6364),m=s(6414),u=s(1401),p=s(6745),h=s(9703),x=s(5645),f=s(2262),w=s(6009),b=s(4086);function v(){return(0,a.jsx)(b.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},children:(0,a.jsxs)("div",{className:"mb-8",children:[(0,a.jsx)("h1",{className:"text-4xl md:text-5xl font-bold mb-2",children:"Dashboard"}),(0,a.jsx)("p",{className:"text-xl text-muted-foreground",children:"Manage your escrows and track your projects"})]})})}function g(e){let{escrows:t}=e,s=t.reduce((e,t)=>e+Number.parseFloat(t.totalAmount)/1e18,0),i=t.reduce((e,t)=>e+Number.parseFloat(t.releasedAmount)/1e18,0),n=e=>e.milestones.some(e=>"disputed"===e.status||"rejected"===e.status),o=t.filter(e=>"active"===e.status&&!n(e)).length;t.filter(e=>"completed"===e.status).length;let c=t.filter(e=>"disputed"===e.status||n(e)).length;return(0,a.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 md:gap-6 mb-8",children:[(0,a.jsxs)(r.Zp,{className:"glass border-primary/20 p-4 md:p-6",children:[(0,a.jsxs)(r.aR,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,a.jsx)(r.ZB,{className:"text-sm font-medium",children:"Total Value"}),(0,a.jsx)(u.A,{className:"h-4 w-4 text-muted-foreground"})]}),(0,a.jsxs)(r.Wu,{children:[(0,a.jsx)("div",{className:"text-2xl font-bold",children:s.toFixed(2)}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"tokens in escrows"})]})]}),(0,a.jsxs)(r.Zp,{className:"glass border-accent/20 p-4 md:p-6",children:[(0,a.jsxs)(r.aR,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,a.jsx)(r.ZB,{className:"text-sm font-medium",children:"Released"}),(0,a.jsx)(f.A,{className:"h-4 w-4 text-muted-foreground"})]}),(0,a.jsxs)(r.Wu,{children:[(0,a.jsx)("div",{className:"text-2xl font-bold",children:i.toFixed(2)}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"tokens released"})]})]}),(0,a.jsxs)(r.Zp,{className:"glass border-primary/20 p-4 md:p-6",children:[(0,a.jsxs)(r.aR,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,a.jsx)(r.ZB,{className:"text-sm font-medium",children:"Active"}),(0,a.jsx)(p.A,{className:"h-4 w-4 text-muted-foreground"})]}),(0,a.jsxs)(r.Wu,{children:[(0,a.jsx)("div",{className:"text-2xl font-bold",children:o}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"projects"})]})]}),(0,a.jsxs)(r.Zp,{className:"glass border-primary/20 p-4 md:p-6",children:[(0,a.jsxs)(r.aR,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,a.jsx)(r.ZB,{className:"text-sm font-medium",children:"Disputed"}),(0,a.jsx)(h.A,{className:"h-4 w-4 text-muted-foreground"})]}),(0,a.jsxs)(r.Wu,{children:[(0,a.jsx)("div",{className:"text-2xl font-bold",children:c}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"projects"})]})]})]})}var j=s(8600),y=s(372),N=s(9671);let A=i.forwardRef((e,t)=>{let{className:s,value:i,...r}=e;return(0,a.jsx)(y.bL,{ref:t,className:(0,N.cn)("relative h-4 w-full overflow-hidden rounded-full bg-secondary",s),...r,children:(0,a.jsx)(y.C1,{className:"h-full w-full flex-1 bg-gradient-to-r from-primary to-accent transition-all",style:{transform:"translateX(-".concat(100-(i||0),"%)")}})})});A.displayName=y.bL.displayName;var T=s(8760),k=s(7811),C=s(2446),E=s(7896),S=s(6782),R=s(5287),M=s(3966),P=s(3850),F=s(1201),D=s(3675),W=s(5655),O=s(447);function L(e){let{escrowId:t,milestoneIndex:r,milestone:m,isPayer:u,isBeneficiary:h,escrowStatus:x,onSuccess:f,allMilestones:w=[],showSubmitButton:b=!0,payerAddress:v,beneficiaryAddress:g}=e,{getContract:y}=(0,n.$)(),{executeTransaction:N,executeBatchTransaction:A,isSmartAccountReady:T}=(0,S.y)(),{isDelegatedFunction:k}=(0,R.k)(),{addNotification:C,addCrossWalletNotification:L}=(0,d.E$)(),{toast:U}=(0,o.dj)(),[_,I]=(0,i.useState)(!1),[B,Z]=(0,i.useState)(!1),[J,$]=(0,i.useState)(null),[z,G]=(0,i.useState)(""),[Y,q]=(0,i.useState)(""),V=w.some(e=>"disputed"===e.status||"rejected"===e.status),H=async e=>{let t=0;for(;t<30;){try{let t=await window.ethereum.request({method:"eth_getTransactionReceipt",params:[e]});if(t)return t}catch(e){}await new Promise(e=>setTimeout(e,2e3)),t++}throw Error("Transaction timeout - please check the blockchain explorer")},X=()=>"submitted"===m.status&&u,K=e=>{$(e),G(""),q(""),Z(!0)},Q=async()=>{if(("dispute"===J||"reject"===J)&&!z.trim()){U({title:"Reason required",description:"Please provide a reason for ".concat("dispute"===J?"disputing":"rejecting"," this milestone"),variant:"destructive"});return}I(!0);try{var e,a,i,n,o,u,p,h;let x;let w=y(c.oB.SECUREFLOW_ESCROW,l.f),b=T&&("approve"===J||"submit"===J||"dispute"===J);switch(k("approve"===J?"approveMilestone":"dispute"===J?"disputeMilestone":""),J){case"start":x=await w.send("startWork",t),U({title:"Work started!",description:"You can now begin working on the milestones"}),L((0,d.xg)("work_started",t,{projectTitle:"Project #".concat(t),freelancerName:"Freelancer"}),v,g);break;case"submit":if(b){let{ethers:e}=await s.e(416).then(s.bind(s,2416)),a=new e.Interface(l.f).encodeFunctionData("submitMilestone",[t,r,m.description]);x=await N(c.oB.SECUREFLOW_ESCROW,a),U({title:"\uD83D\uDE80 Gasless Milestone Submitted!",description:"Milestone submitted with no gas fees using Smart Account delegation"}),L((0,d.A0)("submitted",t,r),v,g)}else x=await w.send("submitMilestone","no-value",t,r,m.description),U({title:"Milestone submitted!",description:"Waiting for client approval"}),L((0,d.A0)("submitted",t,r),v,g);await new Promise(e=>setTimeout(e,2e3)),f();break;case"approve":try{if("submitted"!==m.status){U({title:"Invalid milestone state",description:"This milestone is not in submitted state and cannot be approved",variant:"destructive"});return}if(b){let{ethers:e}=await s.e(416).then(s.bind(s,2416)),a=new e.Interface(l.f).encodeFunctionData("approveMilestone",[t,r]);x=await N(c.oB.SECUREFLOW_ESCROW,a),U({title:"\uD83D\uDE80 Gasless Milestone Approved!",description:"Milestone approved with no gas fees using Smart Account delegation"})}else{try{await w.estimateGas("approveMilestone",t,r)}catch(e){console.log("Gas estimation failed, proceeding with transaction")}let e=0;for(;e<3;)try{x=await w.send("approveMilestone","no-value",t,r);break}catch(t){if(++e>=3)throw t;await new Promise(e=>setTimeout(e,2e3)),U({title:"Retrying transaction",description:"Attempt ".concat(e+1," of ").concat(3,". Please wait..."),variant:"default"})}}try{let e;if(e=x&&"function"==typeof x.wait?await Promise.race([x.wait(),new Promise((e,t)=>setTimeout(()=>t(Error("Transaction timeout")),6e4))]):await H(x),1===e.status)U({title:"Milestone approved!",description:"Payment has been released to the beneficiary"}),L((0,d.A0)("approved",t,r),v,g),Z(!1),await new Promise(e=>setTimeout(e,5e3)),window.dispatchEvent(new CustomEvent("milestoneApproved",{detail:{escrowId:t,milestoneIndex:r}})),f(),await new Promise(e=>setTimeout(e,2e3)),window.location.reload(),window.location.reload();else throw Error("Transaction failed on blockchain")}catch(s){if(x){U({title:"Milestone approved!",description:"Payment has been released to the beneficiary"}),Z(!1),await new Promise(e=>setTimeout(e,5e3)),window.dispatchEvent(new CustomEvent("milestoneApproved",{detail:{escrowId:t,milestoneIndex:r}})),f(),await new Promise(e=>setTimeout(e,2e3)),window.location.reload();return}if(null===(e=s.message)||void 0===e?void 0:e.includes("timeout"))U({title:"Transaction timeout",description:"The transaction is taking longer than expected. Please check the blockchain explorer to see if it was successful.",variant:"destructive"});else throw Error("Transaction failed to confirm on blockchain")}}catch(e){throw(null===(a=e.message)||void 0===a?void 0:a.includes("Not submitted"))?U({title:"Transaction failed",description:"The transaction was not submitted to the network. This may be due to network congestion or wallet issues. Please try again or refresh the page.",variant:"destructive"}):(null===(i=e.message)||void 0===i?void 0:i.includes("Transaction failed on blockchain"))?U({title:"Transaction reverted",description:"The transaction was submitted but failed on the blockchain. The milestone may not be in the correct state for approval.",variant:"destructive"}):(null===(n=e.message)||void 0===n?void 0:n.includes("insufficient funds"))?U({title:"Insufficient funds",description:"You don't have enough MON tokens to pay for the transaction fee.",variant:"destructive"}):(null===(o=e.message)||void 0===o?void 0:o.includes("gas"))?U({title:"Gas estimation failed",description:"Unable to estimate gas for this transaction. The milestone may not be in the correct state.",variant:"destructive"}):U({title:"Approval failed",description:e.message||"An unexpected error occurred while approving the milestone.",variant:"destructive"}),e}finally{I(!1)}break;case"reject":try{if("submitted"!==m.status){U({title:"Invalid milestone state",description:"This milestone is not in submitted state and cannot be rejected",variant:"destructive"});return}if(b){let{ethers:e}=await s.e(416).then(s.bind(s,2416)),a=new e.Interface(l.f).encodeFunctionData("rejectMilestone",[t,r,z]);x=await N(c.oB.SECUREFLOW_ESCROW,a),U({title:"\uD83D\uDE80 Smart Account Milestone rejected!",description:"Milestone rejected using Smart Account with enhanced features"})}else x=await w.send("rejectMilestone","no-value",t,r,z);try{let e;if(e=x&&"function"==typeof x.wait?await Promise.race([x.wait(),new Promise((e,t)=>setTimeout(()=>t(Error("Transaction timeout")),6e4))]):await H(x),1===e.status)U({title:"Milestone rejected!",description:"The milestone has been rejected and the freelancer can resubmit"}),L((0,d.A0)("rejected",t,r,{reason:z}),v,g),Z(!1),f(),await new Promise(e=>setTimeout(e,2e3)),window.location.reload();else throw Error("Transaction failed on blockchain")}catch(e){if(x){U({title:"Milestone rejected!",description:"The milestone has been rejected and the freelancer can resubmit"}),Z(!1),f(),await new Promise(e=>setTimeout(e,2e3)),window.location.reload();return}throw Error("Transaction failed to confirm on blockchain")}}catch(e){U({title:"Rejection failed",description:e.message||"Failed to reject milestone",variant:"destructive"});return}finally{I(!1)}break;case"resubmit":try{if("rejected"!==m.status){U({title:"Invalid milestone state",description:"This milestone is not in rejected state and cannot be resubmitted",variant:"destructive"});return}if(b){let{ethers:e}=await s.e(416).then(s.bind(s,2416)),a=new e.Interface(l.f).encodeFunctionData("resubmitMilestone",[t,r,Y||m.description]);x=await N(c.oB.SECUREFLOW_ESCROW,a),U({title:"\uD83D\uDE80 Smart Account Milestone resubmitted!",description:"Milestone resubmitted using Smart Account with enhanced features"})}else x=await w.send("resubmitMilestone","no-value",t,r,Y||m.description);try{let e;if(e=x&&"function"==typeof x.wait?await Promise.race([x.wait(),new Promise((e,t)=>setTimeout(()=>t(Error("Transaction timeout")),6e4))]):await H(x),1===e.status)U({title:"Milestone resubmitted!",description:"The milestone has been resubmitted and is waiting for client review"}),L((0,d.A0)("submitted",t,r),v,g),Z(!1),f();else throw Error("Transaction failed on blockchain")}catch(e){if(x){U({title:"Milestone resubmitted!",description:"The milestone has been resubmitted and is waiting for client review"}),Z(!1),f();return}throw Error("Transaction failed to confirm on blockchain")}}catch(e){U({title:"Resubmission failed",description:e.message||"Failed to resubmit milestone",variant:"destructive"});return}finally{I(!1)}break;case"dispute":try{if("submitted"!==m.status){U({title:"Invalid milestone state",description:"This milestone is not in submitted state and cannot be disputed",variant:"destructive"});return}if(b){let{ethers:e}=await s.e(416).then(s.bind(s,2416)),a=new e.Interface(l.f).encodeFunctionData("disputeMilestone",[t,r,z]);x=await N(c.oB.SECUREFLOW_ESCROW,a),U({title:"\uD83D\uDE80 Smart Account Dispute created!",description:"Dispute created using Smart Account with enhanced features"}),L((0,d.A0)("disputed",t,r,{reason:z}),v,g)}else x=await w.send("disputeMilestone","no-value",t,r,z);if(!x)throw Error("No transaction hash received - transaction may have failed");try{let e;if(e=x&&"function"==typeof x.wait?await Promise.race([x.wait(),new Promise((e,t)=>setTimeout(()=>t(Error("Transaction timeout")),6e4))]):await H(x),1===e.status)U({title:"Milestone disputed!",description:"The milestone has been disputed and will be reviewed by the admin"}),Z(!1),await new Promise(e=>setTimeout(e,5e3)),window.dispatchEvent(new CustomEvent("milestoneDisputed",{detail:{escrowId:t,milestoneIndex:r}})),f(),await new Promise(e=>setTimeout(e,2e3)),window.location.reload();else throw Error("Transaction failed on blockchain")}catch(e){if(x){U({title:"Milestone disputed!",description:"The milestone has been disputed and will be reviewed by the admin"}),Z(!1),await new Promise(e=>setTimeout(e,5e3)),window.dispatchEvent(new CustomEvent("milestoneDisputed",{detail:{escrowId:t,milestoneIndex:r}})),f(),await new Promise(e=>setTimeout(e,2e3)),window.location.reload();return}throw(null===(u=e.message)||void 0===u?void 0:u.includes("timeout"))?U({title:"Transaction timeout",description:"The transaction is taking longer than expected. Please check the blockchain explorer to see if it was successful.",variant:"destructive"}):U({title:"Transaction failed",description:"The transaction failed to confirm on the blockchain.",variant:"destructive"}),e}}catch(e){throw(null===(p=e.message)||void 0===p?void 0:p.includes("Gas estimation failed"))?U({title:"Transaction failed",description:"Gas estimation failed. The milestone may not be in the correct state for dispute.",variant:"destructive"}):(null===(h=e.message)||void 0===h?void 0:h.includes("Internal JSON-RPC error"))?U({title:"Transaction failed",description:"Network error occurred. Please try again or check your connection.",variant:"destructive"}):U({title:"Dispute failed",description:e.message||"An unexpected error occurred while disputing the milestone.",variant:"destructive"}),e}finally{I(!1)}break;case"resolve":U({title:"Resolution pending",description:"Admin will review and resolve the dispute"})}Z(!1),f()}catch(e){U({title:"Action failed",description:e.message||"Failed to perform action",variant:"destructive"})}finally{I(!1)}},ee=(()=>{switch(J){case"start":return{title:"Start Work",description:"Confirm that you're ready to start working on this project. This will activate the escrow.",icon:M.A,confirmText:"Start Work"};case"submit":return{title:"Submit Milestone",description:"Submit milestone ".concat(r+1," for review. The client will be notified to approve your work."),icon:P.A,confirmText:"Submit"};case"approve":return{title:"Approve Milestone",description:"Approve milestone ".concat(r+1," and release ").concat((Number.parseFloat(m.amount)/1e18).toFixed(2)," tokens to the beneficiary."),icon:p.A,confirmText:"Approve & Release"};case"reject":return{title:"Reject Milestone",description:"Reject milestone ".concat(r+1,". The freelancer will be able to resubmit after making changes."),icon:F.A,confirmText:"Reject"};case"resubmit":return{title:"Resubmit Milestone",description:"Resubmit milestone ".concat(r+1," for client review. Make sure you've addressed the feedback."),icon:P.A,confirmText:"Resubmit"};case"dispute":return{title:"Dispute Milestone",description:"Dispute milestone ".concat(r+1,". This will notify the admin to review the dispute."),icon:D.A,confirmText:"Dispute"};case"resolve":return{title:"Resolve Dispute",description:"As the contract owner, you can resolve this dispute in favor of either party.",icon:D.A,confirmText:"Resolve"};default:return{title:"",description:"",icon:p.A,confirmText:"Confirm"}}})(),et=ee.icon;return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"flex flex-wrap gap-2","data-milestone-actions":"".concat(t,"-").concat(r),children:[b&&(()=>{if("pending"!==m.status||!h||"active"!==x)return!1;if(0===r)return!0;let e=w[r-1];if(!e)return!1;let t="approved"===e.status,s=!1;for(let e=0;e<r;e++){let t=w[e];if(t&&"submitted"===t.status){s=!0;break}}return t&&!s})()&&!V&&(0,a.jsx)(j.$,{onClick:()=>K("submit"),size:"sm",variant:"default",className:"gap-2",children:T?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(W.A,{className:"h-4 w-4"}),"Smart Submit"]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(P.A,{className:"h-4 w-4"}),"Submit"]})}),X()&&!V&&(0,a.jsx)(j.$,{onClick:()=>K("approve"),size:"sm",variant:"default",className:"gap-2",disabled:_,children:T?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(W.A,{className:"h-4 w-4"}),_?"Processing...":"Smart Approve"]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(p.A,{className:"h-4 w-4"}),_?"Processing...":"Approve"]})}),X()&&!V&&(0,a.jsx)(j.$,{onClick:()=>K("reject"),size:"sm",variant:"outline",className:"gap-2 border-red-200 text-red-600 hover:bg-red-50 hover:border-red-300",disabled:_,children:T?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(W.A,{className:"h-4 w-4"}),_?"Processing...":"Smart Reject"]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(F.A,{className:"h-4 w-4"}),_?"Processing...":"Reject"]})}),"submitted"===m.status&&u&&!V&&(0,a.jsx)(j.$,{onClick:()=>K("dispute"),size:"sm",variant:"destructive",className:"gap-2",disabled:_,children:T?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(W.A,{className:"h-4 w-4"}),_?"Processing...":"Smart Dispute"]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(D.A,{className:"h-4 w-4"}),_?"Processing...":"Dispute"]})}),"approved"===m.status&&(0,a.jsxs)("div",{className:"flex items-center gap-2 text-green-600",children:[(0,a.jsx)(p.A,{className:"h-4 w-4"}),(0,a.jsx)("span",{className:"text-sm font-medium",children:"Approved"})]}),"rejected"===m.status&&(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 text-red-600",children:[(0,a.jsx)(O.A,{className:"h-4 w-4"}),(0,a.jsx)("span",{className:"text-sm font-medium",children:"Rejected"})]}),"rejected"===m.status&&h&&(0,a.jsx)(j.$,{onClick:()=>K("resubmit"),size:"sm",variant:"default",className:"gap-2",disabled:_,"data-action":"resubmit",children:T?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(W.A,{className:"h-4 w-4"}),_?"Processing...":"Smart Resubmit"]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(P.A,{className:"h-4 w-4"}),_?"Processing...":"Resubmit"]})})]}),"disputed"===m.status&&(0,a.jsxs)("div",{className:"flex flex-col gap-2 text-orange-600",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(D.A,{className:"h-4 w-4"}),(0,a.jsx)("span",{className:"text-sm font-medium",children:"Disputed"})]}),m.disputeReason&&(0,a.jsxs)("div",{className:"text-xs text-orange-700 bg-orange-50 p-2 rounded border",children:[(0,a.jsx)("strong",{children:"Reason:"})," ",m.disputeReason]})]}),"resolved"===m.status&&(0,a.jsxs)("div",{className:"flex items-center gap-2 text-blue-600",children:[(0,a.jsx)(p.A,{className:"h-4 w-4"}),(0,a.jsx)("span",{className:"text-sm font-medium",children:"Resolved"})]}),V&&(0,a.jsxs)("div",{className:"flex items-center gap-2 text-gray-600",children:[(0,a.jsx)(O.A,{className:"h-4 w-4"}),(0,a.jsx)("span",{className:"text-sm font-medium",children:"Project Terminated"})]})]}),(0,a.jsx)(E.lG,{open:B,onOpenChange:Z,children:(0,a.jsxs)(E.Cf,{className:"glass",children:[(0,a.jsxs)(E.c7,{children:[(0,a.jsxs)("div",{className:"flex items-center gap-3 mb-2",children:[(0,a.jsx)("div",{className:"flex items-center justify-center w-12 h-12 rounded-full bg-primary/10",children:(0,a.jsx)(et,{className:"h-6 w-6 text-primary"})}),(0,a.jsx)(E.L3,{className:"text-2xl",children:ee.title})]}),(0,a.jsx)(E.rr,{className:"text-base leading-relaxed",children:ee.description})]}),(0,a.jsx)("div",{className:"bg-muted/50 rounded-lg p-4 my-4",children:(0,a.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-muted-foreground",children:"Escrow ID:"}),(0,a.jsxs)("span",{className:"font-mono font-semibold",children:["#",t]})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-muted-foreground",children:"Milestone:"}),(0,a.jsx)("span",{className:"font-semibold",children:r+1})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-muted-foreground",children:"Amount:"}),(0,a.jsx)("span",{className:"font-bold text-primary",children:(()=>{try{let e=Number.parseFloat(m.amount);if(isNaN(e))return"0.00";return(e/1e18).toFixed(2)}catch(e){return"0.00"}})()})]})]})}),("dispute"===J||"reject"===J)&&(0,a.jsxs)("div",{className:"my-4",children:[(0,a.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Reason for ","dispute"===J?"dispute":"rejection"," ","(required)"]}),(0,a.jsx)("textarea",{value:z,onChange:e=>G(e.target.value),placeholder:"Please explain why you are ".concat("dispute"===J?"disputing":"rejecting"," this milestone..."),className:"w-full p-3 border border-gray-300 rounded-md resize-none focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent",rows:3,required:!0}),!z.trim()&&(0,a.jsxs)("p",{className:"text-sm text-red-600 mt-1",children:["Please provide a reason for the"," ","dispute"===J?"dispute":"rejection"]})]}),"resubmit"===J&&(0,a.jsxs)("div",{className:"my-4 space-y-4",children:[m.rejectionReason&&(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-red-600 mb-2",children:"Rejection Reason"}),(0,a.jsx)("div",{className:"p-3 bg-red-50 border border-red-200 rounded-lg text-sm text-red-800",children:m.rejectionReason})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Update Message"}),(0,a.jsx)("textarea",{value:Y,onChange:e=>q(e.target.value),placeholder:"Describe the improvements you've made to address the client's feedback...",className:"w-full p-3 border border-gray-300 rounded-md resize-none focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent",rows:4}),(0,a.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"This message will be sent to the client along with your resubmission."})]})]}),(0,a.jsxs)(E.Es,{children:[(0,a.jsx)(j.$,{variant:"outline",onClick:()=>Z(!1),disabled:_,children:"Cancel"}),(0,a.jsx)(j.$,{onClick:Q,disabled:_,children:_?"Processing...":ee.confirmText})]})]})})]})}function U(e){let{escrow:t,index:s,expandedEscrow:i,submittingMilestone:n,onToggleExpanded:o,onApproveMilestone:c,onRejectMilestone:l,onDisputeMilestone:d,onStartWork:u,onDispute:p,calculateDaysLeft:h,getDaysLeftMessage:x}=e,f=t.milestones.some(e=>"disputed"===e.status||"rejected"===e.status),v=e=>{switch(e){case"pending":return"bg-yellow-100 text-yellow-800";case"submitted":return"bg-blue-100 text-blue-800";case"approved":return"bg-green-100 text-green-800";case"disputed":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},g="0"!==t.totalAmount?Number.parseFloat(t.releasedAmount)/Number.parseFloat(t.totalAmount)*100:0,y=t.milestones.filter(e=>"approved"===e.status).length,N=t.milestones.length;return(0,a.jsx)(b.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3,delay:.1*s},children:(0,a.jsxs)(r.Zp,{className:"glass border-primary/20 p-4 md:p-6 hover:border-primary/40 transition-colors",children:[(0,a.jsx)(r.aR,{children:(0,a.jsxs)("div",{className:"flex items-start justify-between",children:[(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)(r.ZB,{className:"text-lg mb-2",children:t.projectDescription}),(0,a.jsxs)("div",{className:"flex items-center gap-4 text-sm text-gray-600",children:[(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[(0,a.jsx)(m.A,{className:"h-4 w-4"}),(0,a.jsxs)("span",{children:[Math.round(t.duration/86400)," days"]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[(0,a.jsx)(T.A,{className:"h-4 w-4"}),(0,a.jsxs)("span",{children:[(Number.parseFloat(t.totalAmount)/1e18).toFixed(2)," ","tokens"]})]})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(w.E,{className:(e=>{switch(e){case"pending":return"bg-yellow-100 text-yellow-800";case"active":return"bg-blue-100 text-blue-800";case"completed":return"bg-green-100 text-green-800";case"disputed":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}})(f?"terminated":t.status),children:f?"terminated":t.status}),(0,a.jsx)(j.$,{variant:"ghost",size:"sm",onClick:()=>o(t.id),className:"cursor-pointer",children:i===t.id?(0,a.jsx)(k.A,{className:"h-4 w-4"}):(0,a.jsx)(C.A,{className:"h-4 w-4"})})]})]})}),(0,a.jsx)(r.Wu,{children:(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"flex items-center justify-between text-sm mb-2",children:[(0,a.jsx)("span",{children:"Progress"}),(0,a.jsxs)("span",{children:[y,"/",N," milestones"]})]}),(0,a.jsx)(A,{value:g,className:"h-2"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-3 gap-4 text-sm",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-gray-600",children:"Total Amount:"}),(0,a.jsxs)("div",{className:"font-semibold",children:[(Number.parseFloat(t.totalAmount)/1e18).toFixed(2)," ","tokens"]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-gray-600",children:"Released:"}),(0,a.jsxs)("div",{className:"font-semibold",children:[(Number.parseFloat(t.releasedAmount)/1e18).toFixed(2)," ","tokens"]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-gray-600",children:"Days Left:"}),(0,a.jsxs)("div",{className:"font-semibold flex items-center gap-1",children:[(0,a.jsx)(m.A,{className:"h-4 w-4"}),(()=>{let e=x(h(t.createdAt,t.duration));return(0,a.jsx)("span",{className:e.color,children:e.text})})()]})]})]}),i===t.id&&(0,a.jsx)("div",{className:"space-y-4 pt-4 border-t",children:(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("h4",{className:"font-medium",children:"Milestones:"}),t.milestones.map((e,s)=>(0,a.jsxs)("div",{className:"flex items-center justify-between p-2 bg-muted/20 rounded",children:[(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("p",{className:"text-sm font-medium",children:e.description}),(0,a.jsxs)("p",{className:"text-xs text-muted-foreground",children:[(Number.parseFloat(e.amount)/1e18).toFixed(2)," ","tokens"]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(w.E,{className:v(e.status),children:e.status}),(0,a.jsx)(L,{escrowId:t.id,milestoneIndex:s,milestone:e,isPayer:t.isClient||!1,isBeneficiary:t.isFreelancer||!1,escrowStatus:t.status,allMilestones:t.milestones,showSubmitButton:!1,payerAddress:t.payer,beneficiaryAddress:t.beneficiary,onSuccess:()=>{window.dispatchEvent(new CustomEvent("escrowUpdated"))}})]})]},s))]})})]})})]})})}function _(e){let{isConnected:t}=e;return t?(0,a.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"inline-block h-12 w-12 animate-spin rounded-full border-4 border-solid border-primary border-r-transparent mb-4"}),(0,a.jsx)("p",{className:"text-muted-foreground",children:"Loading your dashboard..."})]})}):(0,a.jsx)("div",{className:"min-h-screen flex items-center justify-center gradient-mesh",children:(0,a.jsxs)(r.Zp,{className:"glass border-primary/20 p-12 text-center max-w-md",children:[(0,a.jsx)(x.A,{className:"h-16 w-16 mx-auto mb-4 text-muted-foreground"}),(0,a.jsx)("h2",{className:"text-2xl font-bold mb-2",children:"Wallet Not Connected"}),(0,a.jsx)("p",{className:"text-muted-foreground mb-6",children:"Please connect your wallet to view your dashboard"})]})})}function I(){let{wallet:e,getContract:t}=(0,n.$)(),{toast:s}=(0,o.dj)(),{addNotification:m,addCrossWalletNotification:u}=(0,d.E$)(),[p,h]=(0,i.useState)([]),[w,b]=(0,i.useState)(!0),[j,y]=(0,i.useState)(null),[N,A]=(0,i.useState)(null),T=e=>{switch(e){case 0:default:return"pending";case 1:case 4:return"active";case 2:return"completed";case 3:return"disputed"}},k=e=>{let t=["pending","submitted","approved","disputed","resolved","rejected"][e]||"pending";return 5===e&&console.log("Milestone status 5 (Rejected) detected"),t},C=(e,t)=>Math.max(0,Math.ceil((e+1e3*t-Date.now())/864e5)),E=e=>e>7?{text:"".concat(e," days"),color:"text-red-700 dark:text-red-400",bgColor:"bg-red-50 dark:bg-red-900/20"}:e>0?{text:"".concat(e," days"),color:"text-orange-700 dark:text-orange-400",bgColor:"bg-orange-50 dark:bg-orange-900/20"}:{text:"Deadline passed",color:"text-red-700 dark:text-red-400",bgColor:"bg-red-100 dark:bg-red-900/30"},S=async(e,t,s)=>{try{let a=Number(s[11])||0,i=[];for(let s=0;s<a;s++)try{let a=await e.call("milestones",t,s);i.push(a)}catch(e){i.push({description:"Milestone ".concat(s+1," - To be defined"),amount:"0",status:0,submittedAt:0,approvedAt:0})}if(i.length>0)return i.map((e,t)=>{try{let a,i,r="",n="0",o=0,c="",l="";if(e&&"object"==typeof e)try{if(e.description&&e.description.includes("To be defined"))r=e.description,n=e.amount||"0",o=e.status||0,a=e.submittedAt||void 0,i=e.approvedAt||void 0;else try{r=void 0!==e.description?String(e.description):void 0!==e[0]?String(e[0]):"Milestone ".concat(t+1),n=void 0!==e.amount?String(e.amount):void 0!==e[1]?String(e[1]):"0",o=void 0!==e.status?Number(e.status)||0:void 0!==e[2]&&Number(e[2])||0,void 0!==e.submittedAt&&Number(e.submittedAt)>0?a=1e3*Number(e.submittedAt):void 0!==e[3]&&Number(e[3])>0&&(a=1e3*Number(e[3])),void 0!==e.approvedAt&&Number(e.approvedAt)>0?i=1e3*Number(e.approvedAt):void 0!==e[4]&&Number(e[4])>0&&(i=1e3*Number(e[4])),void 0!==e.disputeReason?c=String(e.disputeReason):void 0!==e[7]&&(c=String(e[7])),void 0!==e.rejectionReason?l=String(e.rejectionReason):void 0!==e[7]&&(l=String(e[7])),(Number(n)/1e18).toFixed(2)}catch(e){r="Milestone ".concat(t+1),n="0",o=0}}catch(e){r="Milestone ".concat(t+1),n="0",o=0}else r="Milestone ".concat(t+1),n="0",o=0;let d=k(o);return r&&r.includes("To be defined")?d="pending":1===o?d="submitted":2===o?d="approved":3===o?d="disputed":4===o?d="resolved":5===o?d="rejected":0===o?d=i&&i>0?"approved":a&&a>0?"submitted":"pending":0===t&&s[5]&&Number(s[5])>0&&(d="approved"),{description:r,amount:n,status:d,submittedAt:a,approvedAt:i,disputeReason:c,rejectionReason:l}}catch(e){return{description:"Milestone ".concat(t+1),amount:"0",status:"pending"}}});return[]}catch(e){return[]}};(0,i.useEffect)(()=>{e.isConnected&&R()},[e.isConnected]);let R=async()=>{b(!0);try{let s=t(c.oB.SECUREFLOW_ESCROW,l.f),r=await s.call("nextEscrowId"),n=Number(r),o=[];if(n>1)for(let t=1;t<n;t++)try{var a,i;let r=await s.call("getEscrowSummary",t),n=r[0].toLowerCase()===(null===(a=e.address)||void 0===a?void 0:a.toLowerCase()),c=r[1].toLowerCase()===(null===(i=e.address)||void 0===i?void 0:i.toLowerCase());if(n||c){let e={id:t.toString(),payer:r[0],beneficiary:r[1],isClient:n,isFreelancer:c,token:r[7],totalAmount:r[4].toString(),releasedAmount:r[5].toString(),status:T(Number(r[3])),createdAt:1e3*Number(r[10]),duration:Number(r[8])-Number(r[10]),milestones:await S(s,t,r),projectDescription:r[13]||""};o.push(e)}}catch(e){continue}h(o)}catch(e){s({title:"Failed to load escrows",description:"Could not fetch your escrows from the blockchain",variant:"destructive"})}finally{b(!1)}},M=async(a,i)=>{try{let r=t(c.oB.SECUREFLOW_ESCROW,l.f);if(!r)return;A("".concat(a,"-").concat(i)),await r.send("disputeMilestone",a,i,"Disputed by client"),s({title:"Milestone Disputed",description:"A dispute has been opened for this milestone"});let n=p.find(e=>e.id===a),o=null==n?void 0:n.beneficiary;u((0,d.A0)("disputed",a,i,{reason:"Disputed by client",clientName:e.address.slice(0,6)+"..."+e.address.slice(-4)}),e.address||void 0,o),await new Promise(e=>setTimeout(e,2e3)),await R()}catch(e){s({title:"Dispute Failed",description:"Could not open dispute. Please try again.",variant:"destructive"})}finally{A(null)}},P=async a=>{try{var i;let r=t(c.oB.SECUREFLOW_ESCROW,l.f);if(!r)return;A(a),await r.send("startWork",a),s({title:"Work Started",description:"You have started work on this escrow"});let n=p.find(e=>e.id===a),o=null==n?void 0:n.beneficiary;u((0,d.xg)("work_started",a,{projectTitle:(null===(i=p.find(e=>e.id===a))||void 0===i?void 0:i.projectDescription)||"Project #".concat(a),freelancerName:e.address.slice(0,6)+"..."+e.address.slice(-4)}),e.address||void 0,o),await new Promise(e=>setTimeout(e,2e3)),await R()}catch(e){s({title:"Start Work Failed",description:"Could not start work. Please try again.",variant:"destructive"})}finally{A(null)}},F=async e=>{try{let a=t(c.oB.SECUREFLOW_ESCROW,l.f);if(!a)return;A(e),await a.send("disputeMilestone",e,0,"General dispute"),s({title:"Dispute Opened",description:"A dispute has been opened for this escrow"}),await new Promise(e=>setTimeout(e,2e3)),await R()}catch(e){s({title:"Dispute Failed",description:"Could not open dispute. Please try again.",variant:"destructive"})}finally{A(null)}},D=async(a,i)=>{try{var r;let n;let o=p.find(e=>e.id===a);if(!o||o.payer.toLowerCase()!==(null===(r=e.address)||void 0===r?void 0:r.toLowerCase())){s({title:"Access Denied",description:"Only the job creator can approve milestones",variant:"destructive"});return}A("".concat(a,"-").concat(i));let m=t(c.oB.SECUREFLOW_ESCROW,l.f);if(!m)return;s({title:"Approving milestone...",description:"Please confirm the transaction in your wallet"});let h=await m.send("approveMilestone","no-value",a,i),x=0;for(;x<30;){try{if(n=await window.ethereum.request({method:"eth_getTransactionReceipt",params:[h]}))break}catch(e){}await new Promise(e=>setTimeout(e,2e3)),x++}if(!n)throw Error("Transaction timeout - please check the blockchain explorer");if("0x1"===n.status){s({title:"Milestone Approved!",description:"Payment has been sent to the freelancer"});let t=o.beneficiary;u((0,d.A0)("approved",a,i,{clientName:e.address.slice(0,6)+"..."+e.address.slice(-4),projectTitle:o.projectDescription||"Project #".concat(a)}),e.address||void 0,t),await new Promise(e=>setTimeout(e,3e3));let r=o.milestones[i];Number.parseFloat(r.amount),await R(),window.dispatchEvent(new CustomEvent("milestoneApproved")),setTimeout(()=>{window.location.reload()},1e3)}else throw Error("Transaction failed on blockchain")}catch(e){s({title:"Approval Failed",description:e.message||"Failed to approve milestone",variant:"destructive"})}finally{A(null)}},W=async(a,i,r)=>{try{var n;let o;let d=p.find(e=>e.id===a);if(!d||d.payer.toLowerCase()!==(null===(n=e.address)||void 0===n?void 0:n.toLowerCase())){s({title:"Access Denied",description:"Only the job creator can reject milestones",variant:"destructive"});return}A("".concat(a,"-").concat(i));let m=t(c.oB.SECUREFLOW_ESCROW,l.f);if(!m)return;s({title:"Rejecting milestone...",description:"Please confirm the transaction in your wallet"});let u=await m.send("rejectMilestone","no-value",a,i,r),h=0;for(;h<30;){try{if(o=await window.ethereum.request({method:"eth_getTransactionReceipt",params:[u]}))break}catch(e){}await new Promise(e=>setTimeout(e,2e3)),h++}if(!o)throw Error("Transaction timeout - please check the blockchain explorer");if("0x1"===o.status)s({title:"Milestone Rejected",description:"The freelancer has been notified and can resubmit"}),await R(),setTimeout(()=>{window.location.reload()},1e3);else throw Error("Transaction failed on blockchain")}catch(e){s({title:"Rejection Failed",description:e.message||"Failed to reject milestone",variant:"destructive"})}finally{A(null)}};return e.isConnected?w?(0,a.jsx)(_,{isConnected:e.isConnected}):(p.filter(e=>"completed"===e.status),p.reduce((e,t)=>e+Number.parseFloat(t.totalAmount)/1e18,0).toFixed(2),e.isConnected)?w?(0,a.jsx)("div",{className:"min-h-screen py-12",children:(0,a.jsxs)("div",{className:"container mx-auto px-4",children:[(0,a.jsx)(v,{}),(0,a.jsx)(_,{isConnected:e.isConnected})]})}):(0,a.jsx)("div",{className:"min-h-screen py-12",children:(0,a.jsxs)("div",{className:"container mx-auto px-4",children:[(0,a.jsx)(v,{}),(0,a.jsx)(g,{escrows:p}),0===p.length?(0,a.jsxs)(r.Zp,{className:"glass border-muted p-12 text-center",children:[(0,a.jsx)(f.A,{className:"h-16 w-16 mx-auto mb-4 text-muted-foreground opacity-50"}),(0,a.jsx)("h3",{className:"text-xl font-bold mb-2",children:"No Escrows Found"}),(0,a.jsx)("p",{className:"text-muted-foreground",children:"You don't have any escrows yet. Create one to get started."})]}):(0,a.jsx)("div",{className:"space-y-6",children:p.map((e,t)=>(0,a.jsx)(U,{escrow:e,index:t,expandedEscrow:j,submittingMilestone:N===e.id?"true":"false",onToggleExpanded:()=>y(j===e.id?null:e.id),onApproveMilestone:D,onRejectMilestone:(e,t)=>{W(e,t,"No reason provided")},onDisputeMilestone:M,onStartWork:P,onDispute:F,calculateDaysLeft:C,getDaysLeftMessage:E},e.id))})]})}):(0,a.jsx)("div",{className:"min-h-screen py-12",children:(0,a.jsxs)("div",{className:"container mx-auto px-4",children:[(0,a.jsx)(v,{}),(0,a.jsxs)(r.Zp,{className:"glass border-primary/20 p-12 text-center max-w-md",children:[(0,a.jsx)(x.A,{className:"h-16 w-16 mx-auto mb-4 text-muted-foreground"}),(0,a.jsx)("h2",{className:"text-2xl font-bold mb-2",children:"Connect Your Wallet"}),(0,a.jsx)("p",{className:"text-muted-foreground",children:"Connect your wallet to view your escrows and manage milestones."})]})]})}):(0,a.jsx)("div",{className:"min-h-screen flex items-center justify-center gradient-mesh",children:(0,a.jsxs)(r.Zp,{className:"glass border-primary/20 p-12 text-center max-w-md",children:[(0,a.jsx)(x.A,{className:"h-16 w-16 mx-auto mb-4 text-muted-foreground"}),(0,a.jsx)("h2",{className:"text-2xl font-bold mb-2",children:"Wallet Not Connected"}),(0,a.jsx)("p",{className:"text-muted-foreground mb-6",children:"Please connect your wallet to view your escrows"})]})})}},4369:(e,t,s)=>{Promise.resolve().then(s.bind(s,50))},6364:(e,t,s)=>{"use strict";s.d(t,{A0:()=>d,E$:()=>l,NotificationProvider:()=>c,xg:()=>m,yZ:()=>u});var a=s(3365),i=s(1521),r=s(7408),n=s(740);let o=(0,i.createContext)(void 0);function c(e){let{children:t}=e,{wallet:s}=(0,r.$)(),{toast:c}=(0,n.dj)(),[l,d]=(0,i.useState)([]);(0,i.useEffect)(()=>{if(s.isConnected&&s.address){let e=localStorage.getItem("notifications_".concat(s.address));e?d(JSON.parse(e).map(e=>({...e,timestamp:new Date(e.timestamp)}))):d([])}else d([])},[s.isConnected,s.address]),(0,i.useEffect)(()=>{s.isConnected&&s.address&&localStorage.setItem("notifications_".concat(s.address),JSON.stringify(l))},[l,s.isConnected,s.address]);let m=l.filter(e=>!e.read).length;return(0,a.jsx)(o.Provider,{value:{notifications:l,unreadCount:m,addNotification:(e,t)=>{let a={...e,id:"notification_".concat(Date.now(),"_").concat(Math.random().toString(36).substr(2,9)),timestamp:new Date,read:!1};d(e=>[a,...e]),t&&t.length>0&&t.forEach(e=>{if(e&&e!==s.address){let t=[a,...JSON.parse(localStorage.getItem("notifications_".concat(e))||"[]")];localStorage.setItem("notifications_".concat(e),JSON.stringify(t))}}),("milestone"===e.type||"dispute"===e.type)&&c({title:e.title,description:e.message})},markAsRead:e=>{d(t=>t.map(t=>t.id===e?{...t,read:!0}:t))},markAllAsRead:()=>{d(e=>e.map(e=>({...e,read:!0})))},clearNotifications:()=>{d([])},removeNotification:e=>{d(t=>t.filter(t=>t.id!==e))},addCrossWalletNotification:(e,t,a)=>{var i,r;let n={...e,id:"notification_".concat(Date.now(),"_").concat(Math.random().toString(36).substr(2,9)),timestamp:new Date,read:!1};d(e=>[n,...e]);let o=[];t&&t.toLowerCase()!==(null===(i=s.address)||void 0===i?void 0:i.toLowerCase())&&o.push(t.toLowerCase()),a&&a.toLowerCase()!==(null===(r=s.address)||void 0===r?void 0:r.toLowerCase())&&o.push(a.toLowerCase()),o.forEach(e=>{let t=[n,...JSON.parse(localStorage.getItem("notifications_".concat(e))||"[]")];localStorage.setItem("notifications_".concat(e),JSON.stringify(t))}),("milestone"===e.type||"dispute"===e.type)&&c({title:e.title,description:e.message})}},children:t})}function l(){let e=(0,i.useContext)(o);if(void 0===e)throw Error("useNotifications must be used within a NotificationProvider");return e}let d=(e,t,s,a)=>{let i={escrowId:t,milestoneIndex:s,...a};switch(e){case"submitted":return{type:"milestone",title:"New Milestone Submitted",message:"Milestone ".concat(s+1," has been submitted for review"),actionUrl:"/dashboard?escrow=".concat(t),data:i};case"approved":return{type:"milestone",title:"Milestone Approved!",message:"Milestone ".concat(s+1," has been approved and payment released"),actionUrl:"/freelancer?escrow=".concat(t),data:i};case"rejected":return{type:"milestone",title:"Milestone Rejected",message:"Milestone ".concat(s+1," has been rejected. Please review and resubmit"),actionUrl:"/freelancer?escrow=".concat(t),data:i};case"disputed":return{type:"dispute",title:"Milestone Disputed",message:"Milestone ".concat(s+1," is under dispute and requires admin review"),actionUrl:"/admin?escrow=".concat(t),data:i};default:return{type:"milestone",title:"Milestone Update",message:"Milestone ".concat(s+1," status updated"),actionUrl:"/dashboard?escrow=".concat(t),data:i}}},m=(e,t,s)=>{let a={escrowId:t,...s};switch(e){case"created":return{type:"escrow",title:"New Escrow Created",message:"A new escrow has been created and is ready for work",actionUrl:"/dashboard?escrow=".concat(t),data:a};case"completed":return{type:"escrow",title:"Escrow Completed!",message:"All milestones have been completed and payments released",actionUrl:"/dashboard?escrow=".concat(t),data:a};case"refunded":return{type:"escrow",title:"Escrow Refunded",message:"The escrow has been refunded due to project cancellation",actionUrl:"/dashboard?escrow=".concat(t),data:a};case"work_started":return{type:"escrow",title:"Work Started!",message:"".concat((null==s?void 0:s.freelancerName)||"Freelancer"," has started work on ").concat((null==s?void 0:s.projectTitle)||"Project #".concat(t)),actionUrl:"/dashboard?escrow=".concat(t),data:a};default:return{type:"escrow",title:"Escrow Update",message:"Escrow status has been updated",actionUrl:"/dashboard?escrow=".concat(t),data:a}}},u=(e,t,s,a)=>{let i={jobId:t,freelancerAddress:s,...a};switch(e){case"submitted":return{type:"application",title:"New Job Application",message:"Someone applied to your job: ".concat((null==a?void 0:a.jobTitle)||"Job #".concat(t)),actionUrl:"/approvals?job=".concat(t),data:i};case"approved":return{type:"application",title:"Application Approved!",message:"Your application for ".concat((null==a?void 0:a.jobTitle)||"Job #".concat(t)," has been approved"),actionUrl:"/freelancer?job=".concat(t),data:i};case"rejected":return{type:"application",title:"Application Rejected",message:"Your application for ".concat((null==a?void 0:a.jobTitle)||"Job #".concat(t)," was not selected"),actionUrl:"/freelancer?job=".concat(t),data:i};default:return{type:"application",title:"Application Update",message:"Application status updated for ".concat((null==a?void 0:a.jobTitle)||"Job #".concat(t)),actionUrl:"/approvals?job=".concat(t),data:i}}}},7896:(e,t,s)=>{"use strict";s.d(t,{Cf:()=>u,Es:()=>h,L3:()=>x,c7:()=>p,lG:()=>c,rr:()=>f,zM:()=>l});var a=s(3365),i=s(1521),r=s(2590),n=s(2196),o=s(9671);let c=r.bL,l=r.l9,d=r.ZL;r.bm;let m=i.forwardRef((e,t)=>{let{className:s,...i}=e;return(0,a.jsx)(r.hJ,{ref:t,className:(0,o.cn)("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",s),...i})});m.displayName=r.hJ.displayName;let u=i.forwardRef((e,t)=>{let{className:s,children:i,...c}=e;return(0,a.jsxs)(d,{children:[(0,a.jsx)(m,{}),(0,a.jsxs)(r.UC,{ref:t,className:(0,o.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] rounded-2xl",s),...c,children:[i,(0,a.jsxs)(r.bm,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[(0,a.jsx)(n.A,{className:"h-4 w-4"}),(0,a.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})});u.displayName=r.UC.displayName;let p=e=>{let{className:t,...s}=e;return(0,a.jsx)("div",{className:(0,o.cn)("flex flex-col space-y-1.5 text-center sm:text-left",t),...s})};p.displayName="DialogHeader";let h=e=>{let{className:t,...s}=e;return(0,a.jsx)("div",{className:(0,o.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",t),...s})};h.displayName="DialogFooter";let x=i.forwardRef((e,t)=>{let{className:s,...i}=e;return(0,a.jsx)(r.hE,{ref:t,className:(0,o.cn)("text-lg font-semibold leading-none tracking-tight",s),...i})});x.displayName=r.hE.displayName;let f=i.forwardRef((e,t)=>{let{className:s,...i}=e;return(0,a.jsx)(r.VY,{ref:t,className:(0,o.cn)("text-sm text-muted-foreground",s),...i})});f.displayName=r.VY.displayName}},e=>{var t=t=>e(e.s=t);e.O(0,[202,886,315,590,971,898,654,347,870,358],()=>t(4369)),_N_E=e.O()}]);