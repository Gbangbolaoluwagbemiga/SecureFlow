(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[531],{1892:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(7982).A)("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]])},2657:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>F});var s=a(3365),r=a(1521),l=a(6170),i=a(7408),n=a(740),o=a(5096),d=a(919),c=a(6364),m=a(7460),u=a(4086),x=a(7812),p=a(8600);let h=(0,a(7982).A)("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);var f=a(1892);function b(e){let{searchQuery:t,onSearchChange:a,onRefresh:r,refreshing:l}=e;return(0,s.jsxs)(u.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},children:[(0,s.jsxs)("div",{className:"mb-8",children:[(0,s.jsx)("h1",{className:"text-4xl md:text-5xl font-bold mb-2",children:"Browse Jobs"}),(0,s.jsx)("p",{className:"text-xl text-muted-foreground",children:"Find and apply to open freelance opportunities"})]}),(0,s.jsxs)("div",{className:"flex gap-4 mb-8",children:[(0,s.jsxs)("div",{className:"relative flex-1",children:[(0,s.jsx)(h,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground h-4 w-4"}),(0,s.jsx)(x.p,{placeholder:"Search jobs by description...",value:t,onChange:e=>a(e.target.value),className:"pl-10"})]}),r&&(0,s.jsxs)(p.$,{onClick:r,disabled:l,variant:"outline",size:"sm",className:"shrink-0",children:[(0,s.jsx)(f.A,{className:"h-4 w-4 mr-2 ".concat(l?"animate-spin":"")}),l?"Refreshing...":"Refresh"]})]})]})}var y=a(8760),j=a(6414),g=a(7931);function v(e){let{jobs:t,ongoingProjectsCount:a=0}=e,r=t.reduce((e,t)=>e+Number.parseFloat(t.totalAmount),0),i=t.length>0?t.reduce((e,t)=>e+t.duration,0)/t.length:0;return(0,s.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 md:gap-6 mb-8",children:[(0,s.jsx)(l.Zp,{className:"glass border-primary/20 p-4 md:p-6",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"min-w-0 flex-1",children:[(0,s.jsx)("p",{className:"text-sm text-muted-foreground mb-1",children:"Open Jobs"}),(0,s.jsx)("p",{className:"text-2xl md:text-3xl font-bold break-all",children:t.length})]}),(0,s.jsx)(m.A,{className:"h-8 w-8 md:h-10 md:w-10 text-primary opacity-50 flex-shrink-0"})]})}),(0,s.jsx)(l.Zp,{className:"glass border-accent/20 p-4 md:p-6",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"min-w-0 flex-1",children:[(0,s.jsx)("p",{className:"text-sm text-muted-foreground mb-1",children:"Total Value"}),(0,s.jsxs)("p",{className:"text-2xl md:text-3xl font-bold break-all",children:[(r/1e18).toFixed(2)," tokens"]})]}),(0,s.jsx)(y.A,{className:"h-8 w-8 md:h-10 md:w-10 text-accent opacity-50 flex-shrink-0"})]})}),(0,s.jsx)(l.Zp,{className:"glass border-primary/20 p-4 md:p-6",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"min-w-0 flex-1",children:[(0,s.jsx)("p",{className:"text-sm text-muted-foreground mb-1",children:"Avg. Duration"}),(0,s.jsxs)("p",{className:"text-2xl md:text-3xl font-bold break-all",children:[Math.round(i/86400)," days"]})]}),(0,s.jsx)(j.A,{className:"h-8 w-8 md:h-10 md:w-10 text-primary opacity-50 flex-shrink-0"})]})}),(0,s.jsx)(l.Zp,{className:"glass p-4 md:p-6 ".concat(a>=3?"border-red-200 dark:border-red-800":"border-accent/20"),children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"min-w-0 flex-1",children:[(0,s.jsx)("p",{className:"text-sm text-muted-foreground mb-1",children:"Your Projects"}),(0,s.jsxs)("p",{className:"text-2xl md:text-3xl font-bold break-all ".concat(a>=3?"text-red-600 dark:text-red-400":"text-accent"),children:[a,"/3"]}),a>=3&&(0,s.jsx)("p",{className:"text-xs text-red-600 dark:text-red-400 mt-1",children:"Limit reached"})]}),(0,s.jsx)(g.A,{className:"h-8 w-8 md:h-10 md:w-10 opacity-50 flex-shrink-0 ".concat(a>=3?"text-red-600 dark:text-red-400":"text-accent")})]})})]})}var w=a(6009),N=a(9703);function C(e){let{job:t,index:a,hasApplied:r,isContractPaused:i,ongoingProjectsCount:n,onApply:o}=e;return(0,s.jsx)(u.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3,delay:.1*a},children:(0,s.jsx)(l.Zp,{className:"glass border-primary/20 p-4 md:p-6 hover:border-primary/40 transition-colors",children:(0,s.jsxs)("div",{className:"flex flex-col lg:flex-row lg:items-start lg:justify-between gap-4",children:[(0,s.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3 mb-3",children:[(0,s.jsx)("h3",{className:"text-xl font-bold",children:t.projectDescription||"Job #".concat(t.id)}),(0,s.jsxs)(w.E,{variant:"secondary",className:"gap-1",children:[(0,s.jsx)(j.A,{className:"h-3 w-3"}),t.duration>0?Math.round(t.duration):0," days"]}),(0,s.jsx)(w.E,{className:(e=>{switch(e){case"pending":return"bg-yellow-100 text-yellow-800";case"active":return"bg-blue-100 text-blue-800";case"completed":return"bg-green-100 text-green-800";case"disputed":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}})(t.status),children:t.status})]}),(0,s.jsx)("p",{className:"text-muted-foreground mb-4 break-words overflow-hidden",children:t.projectDescription}),(0,s.jsxs)("div",{className:"flex items-center gap-4 text-sm text-muted-foreground",children:[(0,s.jsxs)("span",{children:["Posted ",new Date(t.createdAt).toLocaleDateString()]}),(0,s.jsx)("span",{children:"â€¢"}),(0,s.jsxs)("span",{children:["Budget: ",(Number.parseFloat(t.totalAmount)/1e18).toFixed(2)," ","tokens"]})]})]}),(0,s.jsxs)("div",{className:"flex flex-col items-end gap-4 w-full lg:w-auto",children:[(0,s.jsxs)("div",{className:"text-right w-full lg:w-auto",children:[(0,s.jsx)("p",{className:"text-sm text-muted-foreground mb-1",children:"Total Budget"}),(0,s.jsx)("p",{className:"text-2xl md:text-3xl font-bold text-primary break-all",children:(Number.parseFloat(t.totalAmount)/1e18).toFixed(2)})]}),(0,s.jsx)(p.$,{onClick:()=>o(t),disabled:r||i||t.isJobCreator||n>=3,className:"w-full lg:w-auto min-w-[140px]",children:i?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(N.A,{className:"h-4 w-4 mr-2"}),"Contract Paused"]}):t.isJobCreator?"Your Job":r?"Applied":n>=3?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(N.A,{className:"h-4 w-4 mr-2"}),"Project Limit (3/3)"]}):"Apply Now"})]})]})})})}var A=a(2770),k=a(7674),S=a(7896);function L(e){let{job:t,open:a,onOpenChange:l,onApply:i,applying:n}=e,[o,d]=(0,r.useState)(""),[c,m]=(0,r.useState)("");return(0,s.jsx)(S.lG,{open:a,onOpenChange:l,children:(0,s.jsxs)(S.Cf,{className:"glass max-w-2xl",children:[(0,s.jsxs)(S.c7,{children:[(0,s.jsxs)(S.L3,{children:["Apply to ",(null==t?void 0:t.projectDescription)||"Job #".concat((null==t?void 0:t.id)||"Unknown")]}),(0,s.jsx)(S.rr,{children:"Submit your application for this freelance opportunity."})]}),(0,s.jsxs)("div",{className:"space-y-4 py-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(A.J,{htmlFor:"coverLetter",children:"Cover Letter *"}),(0,s.jsx)(k.T,{id:"coverLetter",placeholder:"Tell us why you're the best fit for this job...",value:o,onChange:e=>d(e.target.value),className:"min-h-[120px]",required:!0})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(A.J,{htmlFor:"proposedTimeline",children:"Proposed Timeline (days) *"}),(0,s.jsx)(x.p,{id:"proposedTimeline",type:"number",placeholder:"e.g., 7",value:c,onChange:e=>m(e.target.value),min:"1",required:!0})]})]}),(0,s.jsxs)(S.Es,{children:[(0,s.jsx)(p.$,{variant:"outline",onClick:()=>l(!1),children:"Cancel"}),(0,s.jsx)(p.$,{onClick:()=>{t&&o.trim()&&c.trim()&&(i(t,o,c),d(""),m(""))},disabled:n||!o.trim()||!c.trim(),children:n?"Applying...":"Submit Application"})]})]})})}var E=a(5645);function P(e){let{isConnected:t}=e;return t?(0,s.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("div",{className:"inline-block h-12 w-12 animate-spin rounded-full border-4 border-solid border-primary border-r-transparent mb-4"}),(0,s.jsx)("p",{className:"text-muted-foreground",children:"Loading available jobs..."})]})}):(0,s.jsx)("div",{className:"min-h-screen flex items-center justify-center gradient-mesh",children:(0,s.jsxs)(l.Zp,{className:"glass border-primary/20 p-12 text-center max-w-md",children:[(0,s.jsx)(E.A,{className:"h-16 w-16 mx-auto mb-4 text-muted-foreground"}),(0,s.jsx)("h2",{className:"text-2xl font-bold mb-2",children:"Wallet Not Connected"}),(0,s.jsx)("p",{className:"text-muted-foreground mb-6",children:"Please connect your wallet to browse and apply to jobs"})]})})}function F(){let{wallet:e,getContract:t}=(0,i.$)(),{toast:a}=(0,n.dj)(),{addNotification:u}=(0,c.E$)(),[x,p]=(0,r.useState)([]),[h,f]=(0,r.useState)(!0),[y,j]=(0,r.useState)(""),[g,w]=(0,r.useState)(null),[N,A]=(0,r.useState)(""),[k,S]=(0,r.useState)(""),[E,F]=(0,r.useState)(!1),[O,R]=(0,r.useState)({}),[J,T]=(0,r.useState)(!1),[W,M]=(0,r.useState)(0),[_,D]=(0,r.useState)(!1),q=e=>{switch(e){case 0:case 4:default:return"pending";case 1:return"active";case 2:return"completed";case 3:return"disputed"}};(0,r.useEffect)(()=>{e.address&&(Y(),B()),U()},[e.address]),(0,r.useEffect)(()=>{e.address&&x.length>0&&Z()},[e.address,x]);let U=async()=>{try{let e=t(o.oB.SECUREFLOW_ESCROW,d.f),a=await e.call("paused"),s=!1;if(!0===a||"true"===a||1===a)s=!0;else if(!1===a||"false"===a||0===a)s=!1;else if(a&&"object"==typeof a)try{let e=a.toString();s="true"===e||"1"===e}catch(e){s=!1}T(s)}catch(e){T(!1)}},B=async()=>{try{let a=t(o.oB.SECUREFLOW_ESCROW,d.f),s=await a.call("nextEscrowId"),r=Number(s),l=0;if(r>1)for(let t=1;t<r;t++)try{let s=await a.call("getEscrowSummary",t),r=s[0],i=s[1],n=e.address,o=r&&n&&r.toLowerCase()===n.toLowerCase(),d=i&&n&&i.toLowerCase()===n.toLowerCase();if(o||d){let e=Number(s[3]);(0===e||1===e)&&l++}}catch(e){continue}M(l)}catch(e){M(0)}},Z=async()=>{try{let a=t(o.oB.SECUREFLOW_ESCROW,d.f),s={};for(let t of x)try{let r=await a.call("hasUserApplied",t.id,e.address);s[t.id]=!!r}catch(e){s[t.id]=!1}R(s)}catch(e){}},$=async()=>{D(!0);try{await Promise.all([Y(),B()]),e.address&&x.length>0&&await Z()}finally{D(!1)}};(0,r.useEffect)(()=>{R({})},[e.address]);let Y=async()=>{f(!0);try{let a=t(o.oB.SECUREFLOW_ESCROW,d.f),r=await a.call("nextEscrowId"),l=Number(r),i=[];if(l>1)for(let t=1;t<l;t++)try{let r=await a.call("getEscrowSummary",t);if("0x0000000000000000000000000000000000000000"===r[1]){var s;let l=r[0].toLowerCase()===(null===(s=e.address)||void 0===s?void 0:s.toLowerCase()),n=!1;if(e.address&&!l)try{let s=await a.call("hasUserApplied",t,e.address);if(s&&"object"==typeof s)try{let e=s[0]||s.toString();n=!0===e||"true"===e||1===e||"1"===e}catch(e){n=!1}else n=!0===s||"true"===s||1===s;if(R(e=>({...e,[t]:n})),!n)try{let s=null;try{s=await a.call("getApplicationsPage",t,0,1)}catch(e){try{s=await a.call("getApplicationsPage",t,0,10)}catch(e){throw e}}s&&Array.isArray(s)&&s.some(t=>{var a;return t.freelancer&&t.freelancer.toLowerCase()===(null===(a=e.address)||void 0===a?void 0:a.toLowerCase())})&&(n=!0,R(e=>({...e,[t]:!0})))}catch(e){}}catch(e){n=!1}let o=0;try{let e=await a.call("getApplicationsPage",t,0,100);o=e?e.length:0}catch(e){o=0}let d={id:t.toString(),payer:r[0],beneficiary:r[1],token:r[7],totalAmount:r[4].toString(),releasedAmount:r[5].toString(),status:q(Number(r[3])),createdAt:1e3*Number(r[10]),duration:Math.max(0,Math.round((Number(r[8])-Number(r[10]))/86400)),milestones:[],projectDescription:r[14]||"",isOpenJob:!0,applications:[],applicationCount:o,isJobCreator:l};i.push(d),R(e=>({...e,[d.id]:n}))}}catch(e){continue}p(i)}catch(e){a({title:"Failed to load jobs",description:"Could not fetch available jobs from the blockchain",variant:"destructive"})}finally{f(!1)}},H=async(s,r,l)=>{if(s&&e.isConnected){if(W>=3){a({title:"Project Limit Reached",description:"You can only have a maximum of 3 ongoing projects at a time. Please complete or cancel some projects before applying to new ones.",variant:"destructive"});return}if(O[s.id]){a({title:"Already Applied",description:"You have already applied to this job.",variant:"destructive"});return}F(!0);try{let i=t(o.oB.SECUREFLOW_ESCROW,d.f);if(!i)return;let n=!1;try{let t=await i.call("hasUserApplied",s.id,e.address);if(t&&"object"==typeof t)try{let e=t[0]||t.toString();n=!0===e||"true"===e||1===e||"1"===e}catch(e){n=!1}else n=!0===t||"true"===t||1===t}catch(e){n=!1}if(!n)try{let t=await i.call("getApplicationsPage",s.id,0,100);t&&Array.isArray(t)&&(n=t.some(t=>{var a;let s=t.freelancer||t[0];return s&&s.toLowerCase()===(null===(a=e.address)||void 0===a?void 0:a.toLowerCase())}))}catch(e){}if(n){a({title:"Already Applied",description:"You have already applied to this job.",variant:"destructive"}),F(!1);return}await i.send("applyToJob","no-value",s.id,r,l),a({title:"Application Submitted!",description:"The client will review your application and get back to you."}),u((0,c.yZ)("submitted",Number(s.id),e.address,{jobTitle:s.projectDescription||"Job #".concat(s.id),freelancerName:e.address.slice(0,6)+"..."+e.address.slice(-4)}),[s.payer]),A(""),S(""),w(null),R(e=>({...e,[s.id]:!0})),await Y(),await B()}catch(e){a({title:"Application Failed",description:"Could not submit your application. Please try again.",variant:"destructive"})}finally{F(!1)}}},I=x.filter(e=>{var t;return(null===(t=e.projectDescription)||void 0===t?void 0:t.toLowerCase().includes(y.toLowerCase()))||e.milestones.some(e=>e.description.toLowerCase().includes(y.toLowerCase()))});return!e.isConnected||h?(0,s.jsx)(P,{isConnected:e.isConnected}):(0,s.jsx)("div",{className:"min-h-screen py-12",children:(0,s.jsxs)("div",{className:"container mx-auto px-4",children:[(0,s.jsx)(b,{searchQuery:y,onSearchChange:j,onRefresh:$,refreshing:_}),(0,s.jsx)(v,{jobs:x,ongoingProjectsCount:W}),(0,s.jsx)("div",{className:"space-y-6",children:0===I.length?(0,s.jsxs)(l.Zp,{className:"glass border-muted p-12 text-center",children:[(0,s.jsx)(m.A,{className:"h-16 w-16 mx-auto mb-4 text-muted-foreground opacity-50"}),(0,s.jsx)("p",{className:"text-muted-foreground",children:"No jobs found matching your search"})]}):I.map((e,t)=>(0,s.jsx)(C,{job:e,index:t,hasApplied:O[e.id]||!1,isContractPaused:J,ongoingProjectsCount:W,onApply:w},e.id))}),(0,s.jsx)(L,{job:g,open:!!g,onOpenChange:e=>!e&&w(null),onApply:H,applying:E})]})})}},3399:(e,t,a)=>{Promise.resolve().then(a.bind(a,2657))},5645:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(7982).A)("Wallet",[["path",{d:"M19 7V4a1 1 0 0 0-1-1H5a2 2 0 0 0 0 4h15a1 1 0 0 1 1 1v4h-3a2 2 0 0 0 0 4h3a1 1 0 0 0 1-1v-2a1 1 0 0 0-1-1",key:"18etb6"}],["path",{d:"M3 5v14a2 2 0 0 0 2 2h15a1 1 0 0 0 1-1v-4",key:"xoc0q4"}]])},7674:(e,t,a)=>{"use strict";a.d(t,{T:()=>i});var s=a(3365),r=a(1521),l=a(9671);let i=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("textarea",{className:(0,l.cn)("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",a),ref:t,...r})});i.displayName="Textarea"},7812:(e,t,a)=>{"use strict";a.d(t,{p:()=>l});var s=a(3365);a(1521);var r=a(9671);function l(e){let{className:t,type:a,...l}=e;return(0,s.jsx)("input",{type:a,"data-slot":"input",className:(0,r.cn)("file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground dark:bg-input/30 border-input h-9 w-full min-w-0 rounded-md border bg-transparent px-3 py-1 text-base shadow-xs transition-[color,box-shadow] outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm","focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px]","aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",t),...l})}},8760:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(7982).A)("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]])},9703:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(7982).A)("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]])}},e=>{var t=t=>e(e.s=t);e.O(0,[202,886,590,898,899,347,870,358],()=>t(3399)),_N_E=e.O()}]);